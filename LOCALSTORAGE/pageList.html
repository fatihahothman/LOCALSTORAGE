<!DOCTYPE html>

<html>

<head>

    <meta charset="utf-8">

    <title>Section List</title>

    <!-- Mobile Specific Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="YH5NIp1UtyJcMxrrEOwMB3ncsv8UukepUFpUWTO_7yE" />
    <meta name="google-signin-client_id"
        content="538208214824-jg7c1u15he6c9biboek9foog19ntbo4c.apps.googleusercontent.com">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500&family=Roboto:ital,wght@0,400;1,300;1,400&display=swap"
        rel="stylesheet">

    <!-- fontawesome cdn -->

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
    <script src="https://kit.fontawesome.com/a98a5ccfd5.js" crossorigin="anonymous"></script>


    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
        integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" /> -->

    <!--Datatables is a JQuery plugin that supports basic data table functionalities

       such as sorting, searching, and paging without any configurations-->

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">

    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>



    <!-- Bootstrap Scripts -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet">
   
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.lordicon.com//libs/frhvbuzj/lord-icon-2.0.2.js"></script>


    <!-- CSS -->

    <link rel="stylesheet" href="css/editForm.css" />

</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light navbar-laravel">
        <div class="container">
            <a class="navbar-brand" href="#">Slide<strong>Maker</strong></a> <a class="navbar-brand dimmed"
                href="webbook/1029711610510497104111116104109971105552641031099710510846991111092430">Web<strong>Book</strong></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item nav-link nav-name" style="color: #0498fc;">
                        Logged in as nurfatihah othman
                    </li>
                    <li class="nav-item nav-status">
                        <a class="nav-link" href='login.php?logout=1'>Logout</a>
                    </li>
                </ul>

            </div>
        </div>
    </nav>

    <main class="login-form">
        <div class="container-fluid">
            <div class="row">
             <div id="arrPrint"></div>
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-header" style="font-weight: bold;">Section List</div>
                        <div class="card-body">
                            <!-- save as text file -->
                            <!-- display warning message of section more than 2000 sections -->
                            <div id="dataLoading" class="alert alert-info">Loading data</div>
                            <div id="warning" class="alert alert-danger" style="display:none">WARNING: Data overlimit please reduce to 1000 section or less</div>
                            <form method="POST" class="save-form"  id="nameForm"
                                enctype="multipart/form-data">
                                <input  placeholder="Enter file name" type="text" name="filetxtname" id="filetxtname" required style="width:210px;">
                                <input  placeholder="Enter folder name" type="text" name="foldername" id="foldername" required style="width:210px;">
                                <button class="btn btn-success savetext" data-toggle="modal" data-target="" style="width:140px;" name="savetext" onclick="SaveTXT(event)">
                                    <!-- <i class="far fa-save" style="font-size:20px;"></i> -->
                                    &nbsp;Save As Text
                                </button>
                                <button class="btn btn-success saveJS" data-toggle="modal" data-target="" style="width:140px;" name="saveJS" onclick="SaveJS(event)">
                                    <!-- <i class="far fa-save" style="font-size:20px;"></i> -->
                                    &nbsp;Save As JS
                                </button>
                            </form><br>

                             <!-- browse text from content folder only to local storage -->
                            <!-- <div class="row">
                                <input class="col-lg-6 file form-control" type="file" required id="browsetxt" style="width:66%;font-family: Roboto;">&nbsp;
                                <button class="btn btn-primary browse" type="submit" style="width:140px;">
                                    &nbsp;Browse text
                                </button>
                            </div>
                            <br> -->

                            <!-- load text to local storage -->
                            <div class="row">
                                <input class="col-lg-6 file form-control" type="file" required id="myFile" name="loadtxt" style="width:66%;font-family: Roboto;" >&nbsp;
                                <button class="btn btn-primary loadtext" type="submit" style="width:140px;" onclick="loadtext()">
                                    &nbsp;Load Text
                                </button>
                            </div>
                            <br>

                            <!-- add new page -->
                            <div class="custom-file">

                                <button class="btn btn-primary view_files"  type="submit" style="width:140px;">
                                    &nbsp;Browse Text
                                </button>

                                <div class="modal fade" id="filelistModal" tabindex="-1" role="dialog" aria-labelledby="browsetxt" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header pb-1">
                                                <div class="modal-title d-flex"> <i class="fas fa-folder-open"></i>
                                                    <h5 class="ml-2">&nbsp;&nbsp;Content</h5>
                                                </div> <button type="button" class="close" data-bs-dismiss="modal" id="closeModal" aria-label="Close"> <span aria-hidden="true" style="font-size:25px;">&times;</span> </button>
                                            </div>
                                            
                                            <div class="modal-body" id="file_list">
    
                                            </div>
                                            
                                        </div>
                                    </div>
                                </div>

                                <button class="btn btn-primary newpage" onclick="window.location.href='index.php'"
                                    style="width:140px;">
                                    <img src="images/add.png" alt="add" style="width:25px; height:25px;">
                                    New
                                </button>
                            </div>

                            <!-- load page from local storage -->
                            <div class="table-responsive" id="accordion">

                                <table class="table table-bordered table-hover">
                                    <thead>
                                        <tr>

                                            <th scope="col">Section</th>
                                            <th scope="col" style="text-align:center">Action</th>

                                        </tr>
                                    </thead>
                                    <tbody>


                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- </div> -->
                <!-- </div> -->
                <!-- </div> -->
                <br><br>

                <!-- <div class="col"> -->
                <!-- <div class="container"> -->
                <!-- <div class="row"> -->
              
        <!-- </div> -->
        <!-- </div> -->
        </div>

        </div>

    </main>

    <div id="showtxt"></div>
    <script src="js/txt.js"></script>
    <script>
        /*  ==============================================

                    DISPLAY PAGE LIST
        * ================================================= */
        $(document).ready(function () {
            DisplayPage()
        });

        function DisplayPage() {
            let storage = new Array();
            $("#pageList").html(""); //emptying #pageList container so no repeated data is displayed
            // let x = 0; //initlal text box count
            storage = JSON.parse(localStorage.getItem("maindata")) ? JSON.parse(localStorage.getItem("maindata")) :
            [] //get item from local storage
            
            var datasize = storage.length;

            if(datasize>1000) {
                console.log("LENGTH "+datasize+" , DISABLE SAVING");
                $("#nameForm").hide();  //hide save form
                $("#warning").show();  //show warning
                
            }
            
            if (storage) { //if theres data in local storage
                for (let i = 0; i < storage.length; i++) { //loop thru local storage
                    let dataArray = storage[i]; //declaring dataArray to access key in local storage

                    // load page from local storage
                    $('tbody').append(`<tr>
                    <td onclick="window.location=\'index.php?page='+ ${(i + 1)} +'\'" class="col-10 Pagename"><i class='far fa-file-alt' style="font-size:20px;color: #5E55E2;"></i>&nbsp;&nbsp;Section&nbsp;&nbsp;${(i + 1)}</td>
                    <td class="col-2 ActionPage" style="text-align:center"><i class="far fa-trash-alt" onclick="removeMainData(${i});" style="color:#e74c3c;font-size:20px;"></i></i></td>
                    </tr>`);

                   
                }
            }
        }

          /*==========================================================
                       delete full page -maindata local storage
        * ============================================================= */

        function removeMainData(value) {
            // console.log(value);
            // parsing data that was received as JSON;   
            //get item from local storage-returns value of the specified Storage Object item
            storage = JSON.parse(localStorage.getItem("maindata")) ? JSON.parse(localStorage.getItem("maindata")) : [];

            if (storage) {
                for (let i = 1; i < storage.length; i++) { //loop thru local storage


                    if (i == value) { //if value pass in in remove(value) is equal to i 

                        //delete local storage data 
                        //splice() method changes the contents of an array by removing or replacing existing elements and/or adding new elements in place
                        storage.splice(value, 1); //  remove one data at index =value -> splice(start, deleteCount) 

                    }
                }
                // JSON.stringify() method converts a JavaScript object or value to a JSON string before save to local storage
                // because Local storage can only save strings
                // sets the value of the specified Storage Object item.
                localStorage.setItem("maindata", JSON.stringify(storage));
                location.reload(); //reload page

            }

        }

       // Wait for window load
        $(window).on('load', function () {
            $('#dataLoading').hide();
        }) 

       
 

    </script>
</body>



</html>